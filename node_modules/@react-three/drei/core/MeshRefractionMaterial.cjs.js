"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),r=require("react"),t=require("@react-three/fiber"),n=require("three-mesh-bvh"),a=require("../materials/MeshRefractionMaterial.cjs.js");function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function u(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}require("three"),require("./shaderMaterial.cjs.js");var o=i(e),s=u(r);exports.MeshRefractionMaterial=function({frames:e=1,resolution:i=256,near:u=.1,far:c=1e3,aberrationStrength:f=0,...l}){t.extend({MeshRefractionMaterial_:a.MeshRefractionMaterial});const h=r.useRef(),{size:d}=t.useThree(),b=r.useMemo((()=>{const e={};return f>0&&(e.CHROMATIC_ABERRATIONS=""),e}),[f]);return r.useLayoutEffect((()=>{var e,r,t;const a=null==(e=h.current)||null==(r=e.__r3f)||null==(t=r.parent)?void 0:t.geometry;a&&h.current.bvh.updateFrom(new n.MeshBVH(a.toNonIndexed(),{lazyGeneration:!1,strategy:n.SAH}))}),[]),s.createElement("meshRefractionMaterial",o.default({key:JSON.stringify(!!f),defines:b,ref:h,resolution:[d.width,d.height],aberrationStrength:f},l))};
